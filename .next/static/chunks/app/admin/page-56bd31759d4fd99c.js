(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{5782:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(5155),l=s(2115),a=s(8525),d=s(5916),n=s(2619),o=s.n(n),i=s(2319);function c(){let[e,t]=(0,l.useState)(!1),[s,n]=(0,l.useState)(""),[c,m]=(0,l.useState)(!1),[u,x]=(0,l.useState)(""),[h,g]=(0,l.useState)({totalProducts:0,totalOrders:0,totalRevenue:0,recentOrders:[]}),[b,p]=(0,l.useState)(!0);(0,l.useEffect)(()=>{!async function(){try{let e=await fetch("/api/admin/stats");if(e.ok){let t=await e.json();g(t)}}catch(e){console.error("Error loading dashboard data:",e)}finally{p(!1)}}()},[]);let j=async()=>{t(!0),n("");try{let e=await fetch("/api/seed",{method:"POST"}),t=await e.json();if(e.ok){n("Products seeded successfully!");let{count:e}=await a.N.from("parts").select("*",{count:"exact",head:!0});g(t=>({...t,totalProducts:e||0}))}else n("Error: ".concat(t.error))}catch(e){n("Failed to seed products")}finally{t(!1)}},v=async()=>{m(!0),x("");try{let e=await fetch("/api/seed-orders",{method:"POST"}),t=await e.json();if(e.ok){x("Successfully seeded ".concat(t.orders," sample orders!"));let{data:e,count:s}=await a.N.from("orders").select("total_amount",{count:"exact"}),r=(null==e?void 0:e.reduce((e,t)=>e+(t.total_amount||0),0))||0,{data:l}=await a.N.from("orders").select("\n            id,\n            total_amount,\n            status,\n            created_at,\n            order_items (\n              quantity,\n              parts (\n                name\n              )\n            )\n          ").order("created_at",{ascending:!1}).limit(5);g(e=>({...e,totalOrders:s||0,totalRevenue:r,recentOrders:l||[]}))}else x("Error: ".concat(t.error))}catch(e){x("Failed to seed orders")}finally{m(!1)}};return(0,r.jsxs)(i.A,{children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Manage your RPM Auto Parts store"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,r.jsx)("div",{className:"bg-white p-6 rounded-lg shadow border",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-1",children:"Products"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-blue-600",children:b?"...":h.totalProducts.toLocaleString()}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Total Products"})]}),(0,r.jsx)("div",{className:"p-3 bg-blue-100 rounded-full",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10"})})})]})}),(0,r.jsx)("div",{className:"bg-white p-6 rounded-lg shadow border",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-1",children:"Orders"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-green-600",children:b?"...":h.totalOrders.toLocaleString()}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Total Orders"})]}),(0,r.jsx)("div",{className:"p-3 bg-green-100 rounded-full",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})})]})}),(0,r.jsx)("div",{className:"bg-white p-6 rounded-lg shadow border",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-1",children:"Revenue"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-purple-600",children:b?"...":(0,d.v)(h.totalRevenue)}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Total Revenue"})]}),(0,r.jsx)("div",{className:"p-3 bg-purple-100 rounded-full",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow border",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Quick Actions"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("button",{onClick:j,disabled:e,className:"w-full bg-orange-500 text-white px-4 py-3 rounded-lg hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:e?"Seeding Products...":"Seed Sample Products"}),s&&(0,r.jsx)("div",{className:"p-3 rounded-lg text-sm ".concat(s.includes("Error")?"bg-red-100 text-red-700":"bg-green-100 text-green-700"),children:s}),(0,r.jsx)("button",{onClick:v,disabled:c,className:"w-full bg-yellow-500 text-white px-4 py-3 rounded-lg hover:bg-yellow-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:c?"Seeding Orders...":"Seed Sample Orders"}),u&&(0,r.jsx)("div",{className:"p-3 rounded-lg text-sm ".concat(u.includes("Error")?"bg-red-100 text-red-700":"bg-green-100 text-green-700"),children:u}),(0,r.jsx)(o(),{href:"/admin/products",children:(0,r.jsx)("button",{className:"w-full bg-blue-500 text-white px-4 py-3 rounded-lg hover:bg-blue-600 transition-colors font-medium",children:"Manage Products"})}),(0,r.jsx)(o(),{href:"/admin/orders",children:(0,r.jsx)("button",{className:"w-full bg-green-500 text-white px-4 py-3 rounded-lg hover:bg-green-600 transition-colors font-medium",children:"View Orders"})})]})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow border",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Recent Orders"}),b?(0,r.jsx)("div",{className:"space-y-3",children:[1,2,3].map(e=>(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,r.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]},e))}):0===h.recentOrders.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,r.jsx)("svg",{className:"w-12 h-12 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),(0,r.jsx)("p",{children:"No recent orders"}),(0,r.jsx)("p",{className:"text-sm",children:"Orders will appear here once customers start purchasing"})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[h.recentOrders.map(e=>{var t,s,l,a;return(0,r.jsx)("div",{className:"border-b pb-3 last:border-b-0",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-medium",children:["Order #",e.id]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:new Date(e.created_at).toLocaleDateString("en-GB")}),e.order_items&&e.order_items.length>0&&(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[e.order_items.length," item",1!==e.order_items.length?"s":"",(null==(s=e.order_items[0])||null==(t=s.parts)?void 0:t.name)&&" • ".concat(e.order_items[0].parts.name).concat(e.order_items.length>1?"...":"")]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"font-semibold",children:(0,d.v)(e.total_amount)}),(0,r.jsx)("span",{className:"inline-block px-2 py-1 text-xs font-medium rounded-full ".concat((e=>{switch(null==e?void 0:e.toLowerCase()){case"completed":case"delivered":return"text-green-600 bg-green-100";case"cancelled":return"text-red-600 bg-red-100";case"processing":return"text-blue-600 bg-blue-100";default:return"text-orange-600 bg-orange-100"}})(e.status)),children:(null==(l=e.status)?void 0:l.charAt(0).toUpperCase())+(null==(a=e.status)?void 0:a.slice(1))||"Pending"})]})]})},e.id)}),(0,r.jsx)(o(),{href:"/admin/orders",children:(0,r.jsx)("button",{className:"w-full text-blue-600 hover:text-blue-800 text-sm font-medium mt-4 py-2 border border-blue-200 rounded-lg hover:bg-blue-50 transition-colors",children:"View All Orders →"})})]})]})]})]})}},5916:(e,t,s)=>{"use strict";function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GBP";return new Intl.NumberFormat("en-GB",{style:"currency",currency:t}).format(e)}s.d(t,{v:()=>r})},8e3:(e,t,s)=>{Promise.resolve().then(s.bind(s,5782))}},e=>{e.O(0,[494,619,319,441,255,358],()=>e(e.s=8e3)),_N_E=e.O()}]);